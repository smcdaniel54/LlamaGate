name: output-assembler
version: 1.0.0
description: Assembles all outputs into final files
type: workflow
enabled: true

inputs:
  - id: roi_summary
    type: object
    description: ROI summary
    required: true
  - id: recommendations
    type: string
    description: Recommendations markdown
    required: true
  - id: deck_plan
    type: object
    description: Deck plan structure
    required: true
  - id: executive_summary
    type: string
    description: Executive summary
    required: true
  - id: assessment_state
    type: object
    description: Complete assessment state
    required: true
  - id: powerpoint_path
    type: string
    description: Path to PowerPoint file
    required: false
  - id: output_directory
    type: string
    description: Output directory path
    required: false
    default: ./output

outputs:
  - id: output_files
    type: array
    description: List of created output file paths

steps:
  - name: assemble_outputs
    uses: llm.chat
    config:
      model: mistral
      system_prompt: |
        You are a data formatter. Format assessment outputs into file-ready structures.
        Return JSON with file paths and content.
      user_prompt: |
        Assemble output files for this ROI assessment:
        
        ROI Summary: {{inputs.roi_summary}}
        Recommendations: {{inputs.recommendations}}
        Deck Plan: {{inputs.deck_plan}}
        Executive Summary: {{inputs.executive_summary}}
        Assessment State: {{inputs.assessment_state}}
        Output Directory: {{inputs.output_directory}}
        
        Create file structure:
        1. roi_summary.json - Financial metrics
        2. recommendations.md - Business recommendations
        3. deck_plan.json - Presentation structure
        4. assessment_state.json - Complete state
        5. executive_summary.md - Executive summary
        6. valuegate_assessment.pptx - PowerPoint presentation (if generated)
        7. presentation.html - HTML presentation (if generated)
        
        Return JSON with file paths and content for each file.
    outputs:
      output_files: ${steps.assemble_outputs.output.content}
